{
  "active": false,
  "connections": {
    "When clicking ‘Execute workflow’": {
      "main": [
        [
          {
            "node": "policeReportDifficulty",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "violenceType": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [],
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Find and update documents",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Find and update documents": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Find and update documents1": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items1": {
      "main": [
        [],
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields1": {
      "main": [
        [
          {
            "node": "Find and update documents1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "monthlyIncome": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Find and update documents2": {
      "main": [
        [
          {
            "node": "Loop Over Items2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items2": {
      "main": [
        [],
        [
          {
            "node": "Code in JavaScript1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields2": {
      "main": [
        [
          {
            "node": "Find and update documents2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript1": {
      "main": [
        [
          {
            "node": "Edit Fields2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Find and update documents3": {
      "main": [
        [
          {
            "node": "Loop Over Items3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items3": {
      "main": [
        [],
        [
          {
            "node": "Code in JavaScript2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields3": {
      "main": [
        [
          {
            "node": "Find and update documents3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript2": {
      "main": [
        [
          {
            "node": "Edit Fields3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "employmentStatus": {
      "main": [
        [
          {
            "node": "Loop Over Items2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "familyProvider": {
      "main": [
        [
          {
            "node": "Loop Over Items3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Find and update documents4": {
      "main": [
        [
          {
            "node": "Loop Over Items4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items4": {
      "main": [
        [],
        [
          {
            "node": "Code in JavaScript3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields4": {
      "main": [
        [
          {
            "node": "Find and update documents4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript3": {
      "main": [
        [
          {
            "node": "Edit Fields4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "violenceTime": {
      "main": [
        [
          {
            "node": "Loop Over Items4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Find and update documents5": {
      "main": [
        [
          {
            "node": "Loop Over Items5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items5": {
      "main": [
        [],
        [
          {
            "node": "Code in JavaScript4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields5": {
      "main": [
        [
          {
            "node": "Find and update documents5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript4": {
      "main": [
        [
          {
            "node": "Edit Fields5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "externalSupport": {
      "main": [
        [
          {
            "node": "Loop Over Items5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Find and update documents6": {
      "main": [
        [
          {
            "node": "Loop Over Items6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items6": {
      "main": [
        [],
        [
          {
            "node": "Code in JavaScript5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields6": {
      "main": [
        [
          {
            "node": "Find and update documents6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript5": {
      "main": [
        [
          {
            "node": "Edit Fields6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "riskFactors": {
      "main": [
        [
          {
            "node": "Loop Over Items6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Find and update documents7": {
      "main": [
        [
          {
            "node": "Loop Over Items7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items7": {
      "main": [
        [],
        [
          {
            "node": "Code in JavaScript6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields7": {
      "main": [
        [
          {
            "node": "Find and update documents7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript6": {
      "main": [
        [
          {
            "node": "Edit Fields7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "protectiveFactors": {
      "main": [
        [
          {
            "node": "Loop Over Items7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Find and update documents8": {
      "main": [
        [
          {
            "node": "Loop Over Items8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items8": {
      "main": [
        [],
        [
          {
            "node": "Code in JavaScript7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields8": {
      "main": [
        [
          {
            "node": "Find and update documents8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript7": {
      "main": [
        [
          {
            "node": "Edit Fields8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "violencePerpetrator": {
      "main": [
        [
          {
            "node": "Loop Over Items8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Find and update documents9": {
      "main": [
        [
          {
            "node": "Loop Over Items9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items9": {
      "main": [
        [],
        [
          {
            "node": "Code in JavaScript8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields9": {
      "main": [
        [
          {
            "node": "Find and update documents9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript8": {
      "main": [
        [
          {
            "node": "Edit Fields9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "violenceLocation": {
      "main": [
        [
          {
            "node": "Loop Over Items9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Find and update documents10": {
      "main": [
        [
          {
            "node": "Loop Over Items10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items10": {
      "main": [
        [],
        [
          {
            "node": "Code in JavaScript9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields10": {
      "main": [
        [
          {
            "node": "Find and update documents10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript9": {
      "main": [
        [
          {
            "node": "Edit Fields10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "legalActionsTaken": {
      "main": [
        [
          {
            "node": "Loop Over Items10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Find and update documents11": {
      "main": [
        [
          {
            "node": "Loop Over Items11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items11": {
      "main": [
        [],
        [
          {
            "node": "Code in JavaScript10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields11": {
      "main": [
        [
          {
            "node": "Find and update documents11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript10": {
      "main": [
        [
          {
            "node": "Edit Fields11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "policeReportDifficulty": {
      "main": [
        [
          {
            "node": "Loop Over Items11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2026-01-23T15:59:35.462Z",
  "id": "EWz5qhF0d66sc26L",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "Converter camelcas para underline no mongodb",
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        0,
        3088
      ],
      "id": "80e8203b-90b2-419b-8a8a-733b0dcaf804",
      "name": "When clicking ‘Execute workflow’"
    },
    {
      "parameters": {
        "operation": "findOneAndUpdate",
        "collection": "MsrRegisterData",
        "updateKey": "_id",
        "fields": "violenceType",
        "options": {}
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        800,
        0
      ],
      "id": "fa24b6aa-e8e9-4876-9265-756d2473ad4a",
      "name": "Find and update documents",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "collection": "MsrRegisterData",
        "options": {},
        "query": "{\n  \"violenceType\": { \"$exists\": true, \"$ne\": [], \"$ne\": null }\n}"
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        -32,
        0
      ],
      "id": "8568ddb8-90b1-41fb-8cd1-19e37a38ae8f",
      "name": "violenceType",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "batchSize": 5,
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        176,
        0
      ],
      "id": "e67bd607-041a-414b-aa9a-544a3e5259ef",
      "name": "Loop Over Items"
    },
    {
      "parameters": {
        "jsCode": "// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nfunction camelToSnake(str) {\n  if (typeof str !== 'string') return str;\n  return str.replace(/([a-z])([A-Z])/g, '$1_$2').toLowerCase();\n}\n\nfor (const item of $input.all()) {\n    \n    item.json.newViolenceType = item.json.violenceType.map(i => i = camelToSnake(i));\n}\n\nreturn $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        384,
        0
      ],
      "id": "df852579-ea99-4d78-8e4b-df4fc36d103b",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0f629505-065a-40aa-b0cc-b7c40af62351",
              "name": "_id",
              "value": "={{ $json._id }}",
              "type": "string"
            },
            {
              "id": "6666d18f-9765-46c4-b4b3-0e454e1846e9",
              "name": "violenceType",
              "value": "={{ $json.newViolenceType }}",
              "type": "array"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        592,
        0
      ],
      "id": "df1c1387-0e7d-4e72-a313-3122282fabc4",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "operation": "findOneAndUpdate",
        "collection": "MsrRegisterData",
        "updateKey": "_id",
        "fields": "monthlyIncome",
        "options": {}
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        672,
        256
      ],
      "id": "b43bd98b-afdf-4576-9bc8-d71843b3f3b7",
      "name": "Find and update documents1",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "batchSize": 5,
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        192,
        240
      ],
      "id": "87493a86-0126-4cd3-86f6-eefc17ecbc5b",
      "name": "Loop Over Items1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0f629505-065a-40aa-b0cc-b7c40af62351",
              "name": "_id",
              "value": "={{ $json._id }}",
              "type": "string"
            },
            {
              "id": "6666d18f-9765-46c4-b4b3-0e454e1846e9",
              "name": "monthlyIncome",
              "value": "=no_access",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        432,
        256
      ],
      "id": "fbc74964-c280-4d26-b348-d4cdf863b0e1",
      "name": "Edit Fields1"
    },
    {
      "parameters": {
        "collection": "MsrRegisterData",
        "options": {},
        "query": "{\"monthlyIncome\": \"noAccess\"}"
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        -16,
        240
      ],
      "id": "9c2d2834-918b-4ca5-b3ad-3261ee9ede70",
      "name": "monthlyIncome",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "operation": "findOneAndUpdate",
        "collection": "MsrRegisterData",
        "updateKey": "_id",
        "fields": "employmentStatus",
        "options": {}
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        848,
        496
      ],
      "id": "9885f482-6921-4a16-8fd4-9df1f5bb9a49",
      "name": "Find and update documents2",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "batchSize": 5,
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        208,
        480
      ],
      "id": "ed16a6a7-d3f2-4349-8d38-5652c1cd2eba",
      "name": "Loop Over Items2"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0f629505-065a-40aa-b0cc-b7c40af62351",
              "name": "_id",
              "value": "={{ $json._id }}",
              "type": "string"
            },
            {
              "id": "6666d18f-9765-46c4-b4b3-0e454e1846e9",
              "name": "employmentStatus",
              "value": "={{ $json.newEmploymentStatus }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        656,
        496
      ],
      "id": "7f32fe6a-4d08-4c69-808f-b9ee35ed64ca",
      "name": "Edit Fields2"
    },
    {
      "parameters": {
        "collection": "MsrRegisterData",
        "options": {},
        "query": "{\"employmentStatus\": { \"$in\": [\"employedPj\", \"employedClt\", \"studentWithIncome\" ] }}"
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        -64,
        480
      ],
      "id": "d2b491e7-ee88-4f9c-b5f7-c5a67644d7a2",
      "name": "employmentStatus",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nfunction camelToSnake(str) {\n  if (typeof str !== 'string') return str;\n  return str.replace(/([a-z])([A-Z])/g, '$1_$2').toLowerCase();\n}\n\nfor (const item of $input.all()) {\n    \n    item.json.newEmploymentStatus = camelToSnake(item.json.employmentStatus);\n}\n\nreturn $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        464,
        496
      ],
      "id": "d0067ca8-8bfe-45af-845f-de9c058cd13d",
      "name": "Code in JavaScript1"
    },
    {
      "parameters": {
        "operation": "findOneAndUpdate",
        "collection": "MsrRegisterData",
        "updateKey": "_id",
        "fields": "familyProvider",
        "options": {}
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        848,
        752
      ],
      "id": "42829b09-cbae-4f8f-8e5f-1807bfd8d94d",
      "name": "Find and update documents3",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "batchSize": 5,
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        208,
        736
      ],
      "id": "7dec0a0d-729b-449d-90eb-472c17019eb2",
      "name": "Loop Over Items3"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0f629505-065a-40aa-b0cc-b7c40af62351",
              "name": "_id",
              "value": "={{ $json._id }}",
              "type": "string"
            },
            {
              "id": "6666d18f-9765-46c4-b4b3-0e454e1846e9",
              "name": "familyProvider",
              "value": "={{ $json.newFamilyProvider }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        656,
        752
      ],
      "id": "4e232650-3652-436e-bbc7-6a5fad2422ee",
      "name": "Edit Fields3"
    },
    {
      "parameters": {
        "jsCode": "// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nfunction camelToSnake(str) {\n  if (typeof str !== 'string') return str;\n  return str.replace(/([a-z])([A-Z])/g, '$1_$2').toLowerCase();\n}\n\nfor (const item of $input.all()) {\n    \n    item.json.newFamilyProvider = camelToSnake(item.json.familyProvider);\n}\n\nreturn $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        464,
        752
      ],
      "id": "81bf5cb2-b5ac-471a-92be-e42486977b6d",
      "name": "Code in JavaScript2"
    },
    {
      "parameters": {
        "collection": "MsrRegisterData",
        "options": {},
        "query": "{ \"familyProvider\": \"sharedResponsibility\"}"
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        -48,
        752
      ],
      "id": "3982da2e-6608-4228-b8db-5ed112ffd2c4",
      "name": "familyProvider",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "operation": "findOneAndUpdate",
        "collection": "MsrRegisterData",
        "updateKey": "_id",
        "fields": "violenceTime",
        "options": {}
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        832,
        1568
      ],
      "id": "d807a80d-f56d-41cc-8b18-f913f31f2b90",
      "name": "Find and update documents4",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "batchSize": 5,
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        192,
        1552
      ],
      "id": "9ebe4f29-92e8-4fef-9c6d-54422bc5286d",
      "name": "Loop Over Items4"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0f629505-065a-40aa-b0cc-b7c40af62351",
              "name": "_id",
              "value": "={{ $json._id }}",
              "type": "string"
            },
            {
              "id": "6666d18f-9765-46c4-b4b3-0e454e1846e9",
              "name": "violenceTime",
              "value": "={{ $json.newViolenceTime }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        640,
        1568
      ],
      "id": "258d635b-1c35-4fa7-bef8-0f732a2643f3",
      "name": "Edit Fields4"
    },
    {
      "parameters": {
        "jsCode": "// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nfunction camelToSnake(str) {\n  if (typeof str !== 'string') return str;\n  return str.replace(/([a-z])([A-Z])/g, '$1_$2').toLowerCase();\n}\n\nfor (const item of $input.all()) {\n    \n    item.json.newViolenceTime = camelToSnake(item.json.violenceTime);\n}\n\nreturn $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        448,
        1568
      ],
      "id": "d48b8a88-38f7-49bc-94c5-18c00ccf2c41",
      "name": "Code in JavaScript3"
    },
    {
      "parameters": {
        "collection": "MsrRegisterData",
        "options": {},
        "query": "{ \"violenceTime\": {\"$exists\": \"true\", \"$ne\": null}}"
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        -16,
        1552
      ],
      "id": "e92274a3-741b-43e5-bfa5-7c71ffa0a4a2",
      "name": "violenceTime",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "operation": "findOneAndUpdate",
        "collection": "MsrRegisterData",
        "updateKey": "_id",
        "fields": "externalSupport",
        "options": {}
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        816,
        1056
      ],
      "id": "8391fe1a-b57f-481d-ad04-fc01cd4e7a99",
      "name": "Find and update documents5",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        176,
        1040
      ],
      "id": "309802a7-ccf0-4e09-b084-4fea0c922396",
      "name": "Loop Over Items5"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0f629505-065a-40aa-b0cc-b7c40af62351",
              "name": "_id",
              "value": "={{ $json._id }}",
              "type": "string"
            },
            {
              "id": "6666d18f-9765-46c4-b4b3-0e454e1846e9",
              "name": "externalSupport",
              "value": "={{ $json.newexternalSupport }}",
              "type": "array"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        624,
        1056
      ],
      "id": "f34e62bf-1ae5-4bd5-869f-ed5cb507a2e1",
      "name": "Edit Fields5"
    },
    {
      "parameters": {
        "jsCode": "// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nfunction camelToSnake(str) {\n  if (typeof str !== 'string') return str;\n  return str.replace(/([a-z])([A-Z])/g, '$1_$2').toLowerCase();\n}\n\nfor (const item of $input.all()) {\n    \n\n  item.json.newexternalSupport = item.json.externalSupport.map(i => i = camelToSnake(i));\n\n}\n\nreturn $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        432,
        1056
      ],
      "id": "1b748a8b-7fd0-46a8-9a08-1e1953626bcf",
      "name": "Code in JavaScript4"
    },
    {
      "parameters": {
        "collection": "MsrRegisterData",
        "options": {},
        "query": "{ \"externalSupport\": {\"$exists\": \"true\", \"$ne\": \"no\"}}"
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        -32,
        1040
      ],
      "id": "0e21c951-d846-433a-bced-04afd2c8e939",
      "name": "externalSupport",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "content": "## Só em staging",
        "height": 80
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -160,
        1392
      ],
      "typeVersion": 1,
      "id": "2bcc39be-a899-4a27-9a2f-f552df552ee3",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "operation": "findOneAndUpdate",
        "collection": "MsrRegisterData",
        "updateKey": "_id",
        "fields": "riskFactors",
        "options": {}
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        832,
        1824
      ],
      "id": "133f11b4-1cad-4de5-bbc7-de4dec089485",
      "name": "Find and update documents6",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        192,
        1808
      ],
      "id": "9ae93714-daed-4485-a711-4337359ad8f1",
      "name": "Loop Over Items6"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0f629505-065a-40aa-b0cc-b7c40af62351",
              "name": "_id",
              "value": "={{ $json._id }}",
              "type": "string"
            },
            {
              "id": "6666d18f-9765-46c4-b4b3-0e454e1846e9",
              "name": "riskFactors",
              "value": "={{ $json.newriskFactors }}",
              "type": "array"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        640,
        1824
      ],
      "id": "29ed1dc5-5671-4906-99df-3f57f05c9707",
      "name": "Edit Fields6"
    },
    {
      "parameters": {
        "jsCode": "// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nfunction camelToSnake(str) {\n  if (typeof str !== 'string') return str;\n  return str.replace(/([a-z])([A-Z])/g, '$1_$2').toLowerCase();\n}\n\nfor (const item of $input.all()) {\n\n   item.json.newriskFactors = item.json.riskFactors.map(i => i = camelToSnake(i));\n}\n\nreturn $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        448,
        1824
      ],
      "id": "4a3273dd-60f7-44fb-ac9b-7c8e9b57afd6",
      "name": "Code in JavaScript5"
    },
    {
      "parameters": {
        "collection": "MsrRegisterData",
        "options": {},
        "query": "{ \"riskFactors\": {\"$exists\": \"true\", \"$ne\": []}}"
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        -32,
        1808
      ],
      "id": "a369efa8-7af7-448b-bb4e-171d7f56f845",
      "name": "riskFactors",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "operation": "findOneAndUpdate",
        "collection": "MsrRegisterData",
        "updateKey": "_id",
        "fields": "protectiveFactors",
        "options": {}
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        896,
        2176
      ],
      "id": "210f01d7-2ec1-443f-941e-c8cff4f88103",
      "name": "Find and update documents7",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "batchSize": 5,
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        256,
        2160
      ],
      "id": "115ee4d7-8a95-4a9d-a798-033aa3d36045",
      "name": "Loop Over Items7"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0f629505-065a-40aa-b0cc-b7c40af62351",
              "name": "_id",
              "value": "={{ $json._id }}",
              "type": "string"
            },
            {
              "id": "6666d18f-9765-46c4-b4b3-0e454e1846e9",
              "name": "protectiveFactors",
              "value": "={{ $json.newprotectiveFactors }}",
              "type": "array"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        704,
        2176
      ],
      "id": "2382d6c1-bc07-401f-92ea-c924e3a99fd0",
      "name": "Edit Fields7"
    },
    {
      "parameters": {
        "jsCode": "// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nfunction camelToSnake(str) {\n  if (typeof str !== 'string') return str;\n  return str.replace(/([a-z])([A-Z])/g, '$1_$2').toLowerCase();\n}\n\nfor (const item of $input.all()) {\n\n   item.json.newprotectiveFactors = item.json.protectiveFactors.map(i => i = camelToSnake(i));\n}\n\nreturn $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        512,
        2176
      ],
      "id": "80c0d94b-10a7-4da0-acf3-75369f6fa2fa",
      "name": "Code in JavaScript6"
    },
    {
      "parameters": {
        "collection": "MsrRegisterData",
        "options": {},
        "query": "{ \"protectiveFactors\": {\"$exists\": \"true\", \"$ne\": []}}"
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        32,
        2160
      ],
      "id": "0dd5331c-31f5-493f-b5e9-fa10839253f4",
      "name": "protectiveFactors",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "operation": "findOneAndUpdate",
        "collection": "MsrRegisterData",
        "updateKey": "_id",
        "fields": "violencePerpetrator",
        "options": {}
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        912,
        2416
      ],
      "id": "88dbc4dd-b6b4-4b57-82ff-f3fabfb06bb0",
      "name": "Find and update documents8",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "batchSize": 5,
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        272,
        2400
      ],
      "id": "6f0e43c2-e336-42ed-974f-41e573ae5beb",
      "name": "Loop Over Items8"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0f629505-065a-40aa-b0cc-b7c40af62351",
              "name": "_id",
              "value": "={{ $json._id }}",
              "type": "string"
            },
            {
              "id": "6666d18f-9765-46c4-b4b3-0e454e1846e9",
              "name": "violencePerpetrator",
              "value": "={{ $json.newviolencePerpetrator }}",
              "type": "array"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        720,
        2416
      ],
      "id": "7be3192d-5d05-4bac-97ed-a464b5c97302",
      "name": "Edit Fields8"
    },
    {
      "parameters": {
        "jsCode": "// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nfunction camelToSnake(str) {\n  if (typeof str !== 'string') return str;\n  return str.replace(/([a-z])([A-Z])/g, '$1_$2').toLowerCase();\n}\n\nfor (const item of $input.all()) {\n\n   item.json.newviolencePerpetrator = item.json.violencePerpetrator.map(i => i = camelToSnake(i));\n}\n\nreturn $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        528,
        2416
      ],
      "id": "7542f7be-c372-40ce-a3cf-30030dece711",
      "name": "Code in JavaScript7"
    },
    {
      "parameters": {
        "collection": "MsrRegisterData",
        "options": {},
        "query": "{ \"violencePerpetrator\": {\"$exists\": \"true\", \"$ne\": []}}"
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        48,
        2400
      ],
      "id": "5be5227a-29eb-411a-afed-4e0826d0208f",
      "name": "violencePerpetrator",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "operation": "findOneAndUpdate",
        "collection": "MsrRegisterData",
        "updateKey": "_id",
        "fields": "violenceLocation",
        "options": {}
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        1104,
        2688
      ],
      "id": "955b2547-c0a8-4fe1-9be0-d1c4a14ed76f",
      "name": "Find and update documents9",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "batchSize": 5,
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        464,
        2672
      ],
      "id": "41dfe0d2-bf87-439b-9344-85f554bb9df7",
      "name": "Loop Over Items9"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0f629505-065a-40aa-b0cc-b7c40af62351",
              "name": "_id",
              "value": "={{ $json._id }}",
              "type": "string"
            },
            {
              "id": "6666d18f-9765-46c4-b4b3-0e454e1846e9",
              "name": "violenceLocation",
              "value": "={{ $json.newviolenceLocation }}",
              "type": "array"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        912,
        2688
      ],
      "id": "7932e0c2-d589-4749-bb96-370e8ff01dae",
      "name": "Edit Fields9"
    },
    {
      "parameters": {
        "jsCode": "// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nfunction camelToSnake(str) {\n  if (typeof str !== 'string') return str;\n  return str.replace(/([a-z])([A-Z])/g, '$1_$2').toLowerCase();\n}\n\nfor (const item of $input.all()) {\n\n   item.json.newviolenceLocation = item.json.violenceLocation.map(i => i = camelToSnake(i));\n}\n\nreturn $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        720,
        2688
      ],
      "id": "2e232e45-82c2-400d-a43a-8336af243c7b",
      "name": "Code in JavaScript8"
    },
    {
      "parameters": {
        "collection": "MsrRegisterData",
        "options": {},
        "query": "{ \"violenceLocation\": {\"$exists\": \"true\", \"$ne\":[]}}"
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        240,
        2672
      ],
      "id": "67e2da92-75be-4432-b691-24424c024a36",
      "name": "violenceLocation",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "operation": "findOneAndUpdate",
        "collection": "MsrRegisterData",
        "updateKey": "_id",
        "fields": "legalActionsTaken",
        "options": {}
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        1120,
        2896
      ],
      "id": "66fbcbdf-6033-4dcf-9007-cea9f055021f",
      "name": "Find and update documents10",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "batchSize": 5,
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        480,
        2880
      ],
      "id": "1fb8b20d-d52d-4253-80b0-1311566e4955",
      "name": "Loop Over Items10"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0f629505-065a-40aa-b0cc-b7c40af62351",
              "name": "_id",
              "value": "={{ $json._id }}",
              "type": "string"
            },
            {
              "id": "6666d18f-9765-46c4-b4b3-0e454e1846e9",
              "name": "legalActionsTaken",
              "value": "={{ $json.newlegalActionsTaken }}",
              "type": "array"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        928,
        2896
      ],
      "id": "0b926f0a-ff75-4e9f-a03a-bae074f10475",
      "name": "Edit Fields10"
    },
    {
      "parameters": {
        "jsCode": "// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nfunction camelToSnake(str) {\n  if (typeof str !== 'string') return str;\n  return str.replace(/([a-z])([A-Z])/g, '$1_$2').toLowerCase();\n}\n\nfor (const item of $input.all()) {\n\n   item.json.newlegalActionsTaken = item.json.legalActionsTaken.map(i => i = camelToSnake(i));\n}\n\nreturn $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        736,
        2896
      ],
      "id": "7bc9c4cf-6564-475c-b586-1c96519dcebb",
      "name": "Code in JavaScript9"
    },
    {
      "parameters": {
        "collection": "MsrRegisterData",
        "options": {},
        "query": "{ \"legalActionsTaken\": {\"$exists\": \"true\", \"$ne\":[] }}"
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        256,
        2880
      ],
      "id": "8c95cdbf-6113-4c16-be9e-985e48ce9c1e",
      "name": "legalActionsTaken",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "operation": "findOneAndUpdate",
        "collection": "MsrRegisterData",
        "updateKey": "_id",
        "fields": "policeReportDifficulty",
        "options": {}
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        1104,
        3104
      ],
      "id": "8a8bbb60-fa01-4cef-a80e-93b075fdd285",
      "name": "Find and update documents11",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "batchSize": 5,
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        464,
        3088
      ],
      "id": "dc6512ee-9306-47ca-840f-16a17755b658",
      "name": "Loop Over Items11"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0f629505-065a-40aa-b0cc-b7c40af62351",
              "name": "_id",
              "value": "={{ $json._id }}",
              "type": "string"
            },
            {
              "id": "6666d18f-9765-46c4-b4b3-0e454e1846e9",
              "name": "policeReportDifficulty",
              "value": "={{ $json.newpoliceReportDifficulty }}",
              "type": "array"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        912,
        3104
      ],
      "id": "f1709c48-236b-4fed-91de-21f973a4abae",
      "name": "Edit Fields11"
    },
    {
      "parameters": {
        "jsCode": "// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nfunction camelToSnake(str) {\n  if (typeof str !== 'string') return str;\n  return str.replace(/([a-z])([A-Z])/g, '$1_$2').toLowerCase();\n}\n\nfor (const item of $input.all()) {\n\n   item.json.newpoliceReportDifficulty = item.json.policeReportDifficulty.map(i => i = camelToSnake(i));\n}\n\nreturn $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        720,
        3104
      ],
      "id": "7e712ef1-b1e5-4e9f-a8df-204de650dca1",
      "name": "Code in JavaScript10"
    },
    {
      "parameters": {
        "collection": "MsrRegisterData",
        "options": {},
        "query": "{ \"policeReportDifficulty\": {\"$exists\": \"true\", \"$ne\":[] }}"
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        240,
        3088
      ],
      "id": "82bf16b7-cf31-4692-bf41-4eaf86c9b010",
      "name": "policeReportDifficulty",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "shared": [
    {
      "createdAt": "2026-01-23T15:59:35.476Z",
      "updatedAt": "2026-01-23T15:59:35.476Z",
      "role": "workflow:owner",
      "workflowId": "EWz5qhF0d66sc26L",
      "projectId": "rfgBK87HsySgxYKT",
      "project": {
        "createdAt": "2024-11-15T08:07:36.637Z",
        "updatedAt": "2024-11-15T08:07:36.637Z",
        "id": "rfgBK87HsySgxYKT",
        "name": "Desenvolvimento Mapa <dev@mapa.org.br>",
        "type": "personal",
        "icon": null,
        "description": null,
        "projectRelations": [
          {
            "createdAt": "2024-11-15T08:07:36.637Z",
            "updatedAt": "2024-11-15T08:07:36.637Z",
            "userId": "6e437c36-d4e0-42f4-bbc3-d9b5ac96e474",
            "projectId": "rfgBK87HsySgxYKT",
            "user": {
              "createdAt": "2024-01-09T22:21:28.810Z",
              "updatedAt": "2026-01-28T12:48:08.000Z",
              "id": "6e437c36-d4e0-42f4-bbc3-d9b5ac96e474",
              "email": "dev@mapa.org.br",
              "firstName": "Desenvolvimento",
              "lastName": "Mapa",
              "personalizationAnswers": null,
              "settings": {
                "userActivated": true,
                "firstSuccessfulWorkflowId": "sMoToF9HauyKvsFJ",
                "isOnboarded": true,
                "userActivatedAt": 1731658062996,
                "npsSurvey": {
                  "responded": true,
                  "lastShownAt": 1766005013760
                },
                "easyAIWorkflowOnboarded": true
              },
              "disabled": false,
              "mfaEnabled": false,
              "lastActiveAt": "2026-01-28",
              "isPending": false
            }
          }
        ]
      }
    }
  ],
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2026-01-27T01:52:20.000Z",
  "versionId": "71d91966-6583-47fe-ae40-6be220ca7a9b"
}