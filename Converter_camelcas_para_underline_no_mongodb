{
  "active": false,
  "connections": {
    "When clicking ‘Execute workflow’": {
      "main": [
        [
          {
            "node": "violenceType",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "violenceType": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [],
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Find and update documents",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Find and update documents": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Find and update documents1": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items1": {
      "main": [
        [],
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields1": {
      "main": [
        [
          {
            "node": "Find and update documents1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "monthlyIncome": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Find and update documents2": {
      "main": [
        [
          {
            "node": "Loop Over Items2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items2": {
      "main": [
        [],
        [
          {
            "node": "Code in JavaScript1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields2": {
      "main": [
        [
          {
            "node": "Find and update documents2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript1": {
      "main": [
        [
          {
            "node": "Edit Fields2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Find and update documents3": {
      "main": [
        [
          {
            "node": "Loop Over Items3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items3": {
      "main": [
        [],
        [
          {
            "node": "Code in JavaScript2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields3": {
      "main": [
        [
          {
            "node": "Find and update documents3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript2": {
      "main": [
        [
          {
            "node": "Edit Fields3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "employmentStatus": {
      "main": [
        [
          {
            "node": "Loop Over Items2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "familyProvider": {
      "main": [
        [
          {
            "node": "Loop Over Items3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Find and update documents4": {
      "main": [
        [
          {
            "node": "Loop Over Items4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items4": {
      "main": [
        [],
        [
          {
            "node": "Code in JavaScript3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields4": {
      "main": [
        [
          {
            "node": "Find and update documents4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript3": {
      "main": [
        [
          {
            "node": "Edit Fields4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "violenceTime": {
      "main": [
        [
          {
            "node": "Loop Over Items4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Find and update documents5": {
      "main": [
        [
          {
            "node": "Loop Over Items5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items5": {
      "main": [
        [],
        [
          {
            "node": "Code in JavaScript4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields5": {
      "main": [
        [
          {
            "node": "Find and update documents5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript4": {
      "main": [
        [
          {
            "node": "Edit Fields5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "externalSupport": {
      "main": [
        [
          {
            "node": "Loop Over Items5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2026-01-23T15:59:35.462Z",
  "id": "EWz5qhF0d66sc26L",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "Converter camelcas para underline no mongodb",
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -240,
        0
      ],
      "id": "80e8203b-90b2-419b-8a8a-733b0dcaf804",
      "name": "When clicking ‘Execute workflow’"
    },
    {
      "parameters": {
        "operation": "findOneAndUpdate",
        "collection": "MsrRegisterData",
        "updateKey": "_id",
        "fields": "violenceType",
        "options": {}
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        800,
        0
      ],
      "id": "fa24b6aa-e8e9-4876-9265-756d2473ad4a",
      "name": "Find and update documents",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "collection": "MsrRegisterData",
        "options": {},
        "query": "{\n  \"violenceType\": { \"$exists\": true, \"$ne\": [] }\n}"
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        -32,
        0
      ],
      "id": "8568ddb8-90b1-41fb-8cd1-19e37a38ae8f",
      "name": "violenceType",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "batchSize": 5,
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        176,
        0
      ],
      "id": "e67bd607-041a-414b-aa9a-544a3e5259ef",
      "name": "Loop Over Items"
    },
    {
      "parameters": {
        "jsCode": "// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nfunction camelToSnake(str) {\n  if (typeof str !== 'string') return str;\n  return str.replace(/([a-z])([A-Z])/g, '$1_$2').toLowerCase();\n}\n\nfor (const item of $input.all()) {\n    \n    item.json.newViolenceType = item.json.violenceType.map(i => i = camelToSnake(i));\n}\n\nreturn $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        384,
        0
      ],
      "id": "df852579-ea99-4d78-8e4b-df4fc36d103b",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0f629505-065a-40aa-b0cc-b7c40af62351",
              "name": "_id",
              "value": "={{ $json._id }}",
              "type": "string"
            },
            {
              "id": "6666d18f-9765-46c4-b4b3-0e454e1846e9",
              "name": "violenceType",
              "value": "={{ $json.myNewField }}",
              "type": "array"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        592,
        0
      ],
      "id": "df1c1387-0e7d-4e72-a313-3122282fabc4",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "operation": "findOneAndUpdate",
        "collection": "MsrRegisterData",
        "updateKey": "_id",
        "fields": "monthlyIncome",
        "options": {}
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        672,
        256
      ],
      "id": "b43bd98b-afdf-4576-9bc8-d71843b3f3b7",
      "name": "Find and update documents1",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "batchSize": 5,
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        192,
        240
      ],
      "id": "87493a86-0126-4cd3-86f6-eefc17ecbc5b",
      "name": "Loop Over Items1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0f629505-065a-40aa-b0cc-b7c40af62351",
              "name": "_id",
              "value": "={{ $json._id }}",
              "type": "string"
            },
            {
              "id": "6666d18f-9765-46c4-b4b3-0e454e1846e9",
              "name": "monthlyIncome",
              "value": "=no_access",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        432,
        256
      ],
      "id": "fbc74964-c280-4d26-b348-d4cdf863b0e1",
      "name": "Edit Fields1"
    },
    {
      "parameters": {
        "collection": "MsrRegisterData",
        "options": {},
        "query": "{\"monthlyIncome\": \"noAccess\"}"
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        -16,
        240
      ],
      "id": "9c2d2834-918b-4ca5-b3ad-3261ee9ede70",
      "name": "monthlyIncome",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "operation": "findOneAndUpdate",
        "collection": "MsrRegisterData",
        "updateKey": "_id",
        "fields": "employmentStatus",
        "options": {}
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        848,
        496
      ],
      "id": "9885f482-6921-4a16-8fd4-9df1f5bb9a49",
      "name": "Find and update documents2",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "batchSize": 5,
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        208,
        480
      ],
      "id": "ed16a6a7-d3f2-4349-8d38-5652c1cd2eba",
      "name": "Loop Over Items2"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0f629505-065a-40aa-b0cc-b7c40af62351",
              "name": "_id",
              "value": "={{ $json._id }}",
              "type": "string"
            },
            {
              "id": "6666d18f-9765-46c4-b4b3-0e454e1846e9",
              "name": "employmentStatus",
              "value": "={{ $json.newEmploymentStatus }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        656,
        496
      ],
      "id": "7f32fe6a-4d08-4c69-808f-b9ee35ed64ca",
      "name": "Edit Fields2"
    },
    {
      "parameters": {
        "collection": "MsrRegisterData",
        "options": {},
        "query": "{\"employmentStatus\": { \"$in\": [\"employedPj\", \"employedClt\", \"studentWithIncome\" ] }}"
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        -64,
        480
      ],
      "id": "d2b491e7-ee88-4f9c-b5f7-c5a67644d7a2",
      "name": "employmentStatus",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nfunction camelToSnake(str) {\n  if (typeof str !== 'string') return str;\n  return str.replace(/([a-z])([A-Z])/g, '$1_$2').toLowerCase();\n}\n\nfor (const item of $input.all()) {\n    \n    item.json.newEmploymentStatus = camelToSnake(item.json.employmentStatus);\n}\n\nreturn $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        464,
        496
      ],
      "id": "d0067ca8-8bfe-45af-845f-de9c058cd13d",
      "name": "Code in JavaScript1"
    },
    {
      "parameters": {
        "operation": "findOneAndUpdate",
        "collection": "MsrRegisterData",
        "updateKey": "_id",
        "fields": "familyProvider",
        "options": {}
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        848,
        752
      ],
      "id": "42829b09-cbae-4f8f-8e5f-1807bfd8d94d",
      "name": "Find and update documents3",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "batchSize": 5,
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        208,
        736
      ],
      "id": "7dec0a0d-729b-449d-90eb-472c17019eb2",
      "name": "Loop Over Items3"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0f629505-065a-40aa-b0cc-b7c40af62351",
              "name": "_id",
              "value": "={{ $json._id }}",
              "type": "string"
            },
            {
              "id": "6666d18f-9765-46c4-b4b3-0e454e1846e9",
              "name": "familyProvider",
              "value": "={{ $json.newFamilyProvider }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        656,
        752
      ],
      "id": "4e232650-3652-436e-bbc7-6a5fad2422ee",
      "name": "Edit Fields3"
    },
    {
      "parameters": {
        "jsCode": "// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nfunction camelToSnake(str) {\n  if (typeof str !== 'string') return str;\n  return str.replace(/([a-z])([A-Z])/g, '$1_$2').toLowerCase();\n}\n\nfor (const item of $input.all()) {\n    \n    item.json.newFamilyProvider = camelToSnake(item.json.familyProvider);\n}\n\nreturn $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        464,
        752
      ],
      "id": "81bf5cb2-b5ac-471a-92be-e42486977b6d",
      "name": "Code in JavaScript2"
    },
    {
      "parameters": {
        "collection": "MsrRegisterData",
        "options": {},
        "query": "{ \"familyProvider\": \"sharedResponsibility\"}"
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        0,
        736
      ],
      "id": "3982da2e-6608-4228-b8db-5ed112ffd2c4",
      "name": "familyProvider",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "operation": "findOneAndUpdate",
        "collection": "MsrRegisterData",
        "updateKey": "_id",
        "fields": "violenceTime",
        "options": {}
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        848,
        1008
      ],
      "id": "d807a80d-f56d-41cc-8b18-f913f31f2b90",
      "name": "Find and update documents4",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "batchSize": 5,
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        208,
        992
      ],
      "id": "9ebe4f29-92e8-4fef-9c6d-54422bc5286d",
      "name": "Loop Over Items4"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0f629505-065a-40aa-b0cc-b7c40af62351",
              "name": "_id",
              "value": "={{ $json._id }}",
              "type": "string"
            },
            {
              "id": "6666d18f-9765-46c4-b4b3-0e454e1846e9",
              "name": "violenceTime",
              "value": "={{ $json.newViolenceTime }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        656,
        1008
      ],
      "id": "258d635b-1c35-4fa7-bef8-0f732a2643f3",
      "name": "Edit Fields4"
    },
    {
      "parameters": {
        "jsCode": "// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nfunction camelToSnake(str) {\n  if (typeof str !== 'string') return str;\n  return str.replace(/([a-z])([A-Z])/g, '$1_$2').toLowerCase();\n}\n\nfor (const item of $input.all()) {\n    \n    item.json.newViolenceTime = camelToSnake(item.json.violenceTime);\n}\n\nreturn $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        464,
        1008
      ],
      "id": "d48b8a88-38f7-49bc-94c5-18c00ccf2c41",
      "name": "Code in JavaScript3"
    },
    {
      "parameters": {
        "collection": "MsrRegisterData",
        "options": {},
        "query": "{ \"violenceTime\": {\"$exists\": \"true\"}}"
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        0,
        992
      ],
      "id": "e92274a3-741b-43e5-bfa5-7c71ffa0a4a2",
      "name": "violenceTime",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "operation": "findOneAndUpdate",
        "collection": "MsrRegisterData",
        "updateKey": "_id",
        "fields": "externalSupport",
        "options": {}
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        848,
        1264
      ],
      "id": "8391fe1a-b57f-481d-ad04-fc01cd4e7a99",
      "name": "Find and update documents5",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    },
    {
      "parameters": {
        "batchSize": 5,
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        208,
        1248
      ],
      "id": "309802a7-ccf0-4e09-b084-4fea0c922396",
      "name": "Loop Over Items5"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "0f629505-065a-40aa-b0cc-b7c40af62351",
              "name": "_id",
              "value": "={{ $json._id }}",
              "type": "string"
            },
            {
              "id": "6666d18f-9765-46c4-b4b3-0e454e1846e9",
              "name": "externalSupport",
              "value": "={{ $json.newexternalSupport }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        656,
        1264
      ],
      "id": "f34e62bf-1ae5-4bd5-869f-ed5cb507a2e1",
      "name": "Edit Fields5"
    },
    {
      "parameters": {
        "jsCode": "// Loop over input items and add a new field called 'myNewField' to the JSON of each one\nfunction camelToSnake(str) {\n  if (typeof str !== 'string') return str;\n  return str.replace(/([a-z])([A-Z])/g, '$1_$2').toLowerCase();\n}\n\nfor (const item of $input.all()) {\n    \n    item.json.newexternalSupport = camelToSnake(item.json.externalSupport);\n}\n\nreturn $input.all();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        464,
        1264
      ],
      "id": "1b748a8b-7fd0-46a8-9a08-1e1953626bcf",
      "name": "Code in JavaScript4"
    },
    {
      "parameters": {
        "collection": "MsrRegisterData",
        "options": {},
        "query": "{ \"externalSupport\": {\"$exists\": \"true\"}}"
      },
      "type": "n8n-nodes-base.mongoDb",
      "typeVersion": 1.2,
      "position": [
        0,
        1248
      ],
      "id": "0e21c951-d846-433a-bced-04afd2c8e939",
      "name": "externalSupport",
      "credentials": {
        "mongoDb": {
          "id": "9IJGiNaHCwLNS7Lz",
          "name": "[STG] MongoDB"
        }
      }
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "shared": [
    {
      "createdAt": "2026-01-23T15:59:35.476Z",
      "updatedAt": "2026-01-23T15:59:35.476Z",
      "role": "workflow:owner",
      "workflowId": "EWz5qhF0d66sc26L",
      "projectId": "rfgBK87HsySgxYKT",
      "project": {
        "createdAt": "2024-11-15T08:07:36.637Z",
        "updatedAt": "2024-11-15T08:07:36.637Z",
        "id": "rfgBK87HsySgxYKT",
        "name": "Desenvolvimento Mapa <dev@mapa.org.br>",
        "type": "personal",
        "icon": null,
        "description": null,
        "projectRelations": [
          {
            "createdAt": "2024-11-15T08:07:36.637Z",
            "updatedAt": "2024-11-15T08:07:36.637Z",
            "userId": "6e437c36-d4e0-42f4-bbc3-d9b5ac96e474",
            "projectId": "rfgBK87HsySgxYKT",
            "user": {
              "createdAt": "2024-01-09T22:21:28.810Z",
              "updatedAt": "2026-01-26T13:32:09.000Z",
              "id": "6e437c36-d4e0-42f4-bbc3-d9b5ac96e474",
              "email": "dev@mapa.org.br",
              "firstName": "Desenvolvimento",
              "lastName": "Mapa",
              "personalizationAnswers": null,
              "settings": {
                "userActivated": true,
                "firstSuccessfulWorkflowId": "sMoToF9HauyKvsFJ",
                "isOnboarded": true,
                "userActivatedAt": 1731658062996,
                "npsSurvey": {
                  "responded": true,
                  "lastShownAt": 1766005013760
                },
                "easyAIWorkflowOnboarded": true
              },
              "disabled": false,
              "mfaEnabled": false,
              "lastActiveAt": "2026-01-26",
              "isPending": false
            }
          }
        ]
      }
    }
  ],
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2026-01-26T20:42:56.000Z",
  "versionId": "33e9d8f7-6ebd-410c-9c27-cb6c9eb6e199"
}