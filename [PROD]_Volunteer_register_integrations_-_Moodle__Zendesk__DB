{
  "active": true,
  "connections": {
    "Webhook": {
      "main": [
        [
          {
            "node": "Busca voluntária pelo moodle ID",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Busca voluntária pelo moodle ID": {
      "main": [
        [
          {
            "node": "Se retornou a voluntária",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Se retornou a voluntária": {
      "main": [
        [
          {
            "node": "Determina se acessou módulo ou conclusão de curso",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Postgres",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Busca voluntária pelo email": {
      "main": [
        [
          {
            "node": "Se retornou a voluntária do Zendesk",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Monta o assunto do ticket de acordo com a organização da voluntária": {
      "main": [
        [
          {
            "node": "Seta os campos para atualizar voluntária no BD",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cria o ticket de entrada da voluntária pela API do Zendesk": {
      "main": [
        [
          {
            "node": "Seta os campos para inserir na tabela volunteer_status_history",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Seta os campos para atualizar a voluntária no BD": {
      "main": [
        [
          {
            "node": "Atualiza voluntária no BD1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Busca os tickets da voluntária no Zendesk": {
      "main": [
        [
          {
            "node": "Separa os tickets do objeto retornado",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Separa os tickets do objeto retornado": {
      "main": [
        [
          {
            "node": "Se o campo \"Status da Inscrição\" for igual a \"capacitacao\"",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Se retornou a voluntária do Zendesk": {
      "main": [
        [
          {
            "node": "Atualiza status da voluntária no Zendesk1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Stop And Error1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Atualiza status da voluntária no Zendesk": {
      "main": [
        [
          {
            "node": "Monta o assunto do ticket de acordo com a organização da voluntária",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Atualiza status da voluntária no Zendesk1": {
      "main": [
        [
          {
            "node": "Seta os campos para atualizar a voluntária no BD",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Seta os campos para atualizar voluntária no BD": {
      "main": [
        [
          {
            "node": "Atualiza voluntária no BD",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Seta os campos para inserir na tabela volunteer_status_history": {
      "main": [
        [
          {
            "node": "Insere o novo status na tabela volunteer_status_history",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Se o campo \"Status da Inscrição\" for igual a \"capacitacao\"": {
      "main": [
        [
          {
            "node": "Seleciona o ticket mais antigo",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Seleciona o ticket mais antigo": {
      "main": [
        [
          {
            "node": "Atualiza o ticket para \"aprovada\"",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Atualiza o ticket para \"aprovada\"": {
      "main": [
        [
          {
            "node": "Seta os campos para inserir na tabela volunteer_status_history1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Seta os campos para inserir na tabela volunteer_status_history1": {
      "main": [
        [
          {
            "node": "Insere  o registro na volunteer_status_history",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Atualiza voluntária no BD": {
      "main": [
        [
          {
            "node": "Cria o ticket de entrada da voluntária pela API do Zendesk",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Atualiza voluntária no BD1": {
      "main": [
        [
          {
            "node": "Busca os tickets da voluntária no Zendesk",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Determina se acessou módulo ou conclusão de curso": {
      "main": [
        [
          {
            "node": "O atual status da mulher é cadastrada?",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Busca voluntária pelo email",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Busca voluntária pelo email1": {
      "main": [
        [
          {
            "node": "Se retornou a voluntária do Zendesk1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Se retornou a voluntária do Zendesk1": {
      "main": [
        [
          {
            "node": "Atualiza status da voluntária no Zendesk",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Stop And Error2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "O atual status da mulher é cadastrada?": {
      "main": [
        [
          {
            "node": "Busca voluntária pelo email1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "No Operation, do nothing",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Postgres": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "No Operation, do nothing1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Stop And Error",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2024-01-24T01:52:22.279Z",
  "id": "0hojIhmzSHjJnPDe",
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "[PROD] Volunteer register integrations - Moodle / Zendesk / DB",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "moodle-zendesk",
        "options": {}
      },
      "id": "755cbae2-69bf-4deb-92e8-fa787481d63e",
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [
        -880,
        760
      ],
      "webhookId": "3e06675f-aa55-42cd-bfa1-be979b64b575"
    },
    {
      "parameters": {
        "errorMessage": "=Não achou a voluntária\nmoodle_id:  {{$node[\"Webhook\"].json[\"body\"][\"userid\"]}}"
      },
      "id": "3feb912b-0efd-40ce-bd40-d3a17a2576e1",
      "name": "Stop And Error",
      "type": "n8n-nodes-base.stopAndError",
      "typeVersion": 1,
      "position": [
        80,
        1200
      ]
    },
    {
      "parameters": {
        "errorMessage": "=Não achou a voluntária\nvollunteer_id:  {{$node[\"Busca voluntária pelo moodle ID\"].json[\"internal_id\"]}}"
      },
      "id": "df677af8-6cf3-47ef-b1a7-5f60c95b27b6",
      "name": "Stop And Error1",
      "type": "n8n-nodes-base.stopAndError",
      "typeVersion": 1,
      "position": [
        340,
        1080
      ]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "=select * from volunteers v\nwhere moodle_id = {{$node[\"Webhook\"].json[\"body\"][\n\"userid\"]}}",
        "additionalFields": {}
      },
      "id": "a2797037-f471-4eb8-955c-63dc3f458ec1",
      "name": "Busca voluntária pelo moodle ID",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 1,
      "position": [
        -640,
        760
      ],
      "alwaysOutputData": true,
      "credentials": {
        "postgres": {
          "id": "c5mNsjWNXx3mw1Fh",
          "name": "[PROD] Mapa"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{$node[\"Busca voluntária pelo moodle ID\"].json}}",
              "operation": "isNotEmpty"
            }
          ]
        }
      },
      "id": "e906724e-4b46-4f79-a913-2aaf424eff3a",
      "name": "Se retornou a voluntária",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        -440,
        760
      ]
    },
    {
      "parameters": {
        "resource": "user",
        "operation": "search",
        "limit": 30,
        "filters": {
          "query": "={{ $json.email }}"
        }
      },
      "id": "821c6e9a-d42f-49c8-9c02-695311739b64",
      "name": "Busca voluntária pelo email",
      "type": "n8n-nodes-base.zendesk",
      "typeVersion": 1,
      "position": [
        20,
        820
      ],
      "alwaysOutputData": true,
      "credentials": {
        "zendeskApi": {
          "id": "MYAFeR51noxrxEC7",
          "name": "Zendesk account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Loop over input items and add a new field\n// called 'myNewField' to the JSON of each one\nfor (const item of $input.all()) {\n  if (item.json.organization_id == 360269610652) {\n  \titem.json.subject =`[Advogada] ${item.json.name} - ${item.json.user_fields.registration_number}`;\n  } else {\n    item.json.subject =`[Psicóloga] ${item.json.name} - ${item.json.user_fields.registration_number}`;\n  }\n}\n\nreturn $input.all();"
      },
      "id": "3920dc51-99c8-46d1-81a9-92ae6f46c4eb",
      "name": "Monta o assunto do ticket de acordo com a organização da voluntária",
      "type": "n8n-nodes-base.code",
      "typeVersion": 1,
      "position": [
        780,
        60
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://mapadoacolhimento.zendesk.com/api/v2/tickets/",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "zendeskApi",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"ticket\": {\n\t\t\"requester_id\":{{$node[\"Atualiza status da voluntária no Zendesk\"].json[\"id\"]}},\n\t\t\"organization_id\": {{$node[\"Atualiza status da voluntária no Zendesk\"].json[\"organization_id\"]}},\n\t\t\"description\": \"Importado via N8N\",\n\t\t\"subject\": \"{{ $node[\"Monta o assunto do ticket de acordo com a organização da voluntária\"].json[\"subject\"] }}\",\n\t\t\"comment\": {\n\t\t\t\"body\": \"Cadastrada\",\n\t\t\t\"public\": false\n\t\t},\n\t\t\"status\": \"pending\",\n\t\t\"custom_fields\": [\n\t\t\t{\n\t\t\t\t\"id\": 360021879811, \n\t\t\t\t\"value\": \"{{ $node[\"Monta o assunto do ticket de acordo com a organização da voluntária\"].json[\"user_fields\"][\"city\"] }}\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": 360021812712, \n\t\t\t\t\"value\": \"{{ $node[\"Monta o assunto do ticket de acordo com a organização da voluntária\"].json[\"phone\"] }}\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": 360016631592, \n\t\t\t\t\"value\": \"{{ $node[\"Monta o assunto do ticket de acordo com a organização da voluntária\"].json[\"name\"] }}\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": 360021665652, \n\t\t\t\t\"value\": \"{{ $node[\"Monta o assunto do ticket de acordo com a organização da voluntária\"].json[\"user_fields\"][\"condition\"] }}\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"id\": 360021879791,\n\t\t\t\t\"value\": \"{{ $node[\"Monta o assunto do ticket de acordo com a organização da voluntária\"].json[\"user_fields\"][\"state\"] }}\"\n\t\t\t}\n\t\t]\n\t}\n}",
        "options": {}
      },
      "id": "03395f91-68bd-419c-a86b-74872bced949",
      "name": "Cria o ticket de entrada da voluntária pela API do Zendesk",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 3,
      "position": [
        1360,
        60
      ],
      "credentials": {
        "zendeskApi": {
          "id": "MYAFeR51noxrxEC7",
          "name": "Zendesk account"
        }
      }
    },
    {
      "parameters": {
        "keepOnlySet": true,
        "values": {
          "string": [
            {
              "name": "condition",
              "value": "aprovada"
            },
            {
              "name": "updated_at",
              "value": "={{$now}}"
            }
          ],
          "number": [
            {
              "name": "id",
              "value": "={{$node[\"Busca voluntária pelo moodle ID\"].json[\"internal_id\"]}}"
            },
            {
              "name": "zendesk_user_id",
              "value": "={{ $json[\"id\"] }}"
            }
          ]
        },
        "options": {}
      },
      "id": "f7a0f6fd-a864-41e4-b227-68573b450856",
      "name": "Seta os campos para atualizar a voluntária no BD",
      "type": "n8n-nodes-base.set",
      "typeVersion": 1,
      "position": [
        600,
        800
      ]
    },
    {
      "parameters": {
        "url": "=https://mapadoacolhimento.zendesk.com/api/v2/users/{{$node[\"Busca voluntária pelo email\"].json[\"id\"]}}/tickets/requested",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBasicAuth",
        "options": {}
      },
      "id": "48c29a8a-c55e-43e6-a3d9-20b63b60c658",
      "name": "Busca os tickets da voluntária no Zendesk",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 3,
      "position": [
        980,
        800
      ],
      "credentials": {
        "httpBasicAuth": {
          "id": "cw6WdIc7c9HRGleo",
          "name": "Zendesk auth"
        }
      }
    },
    {
      "parameters": {
        "fieldToSplitOut": "tickets",
        "include": "allOtherFields",
        "options": {}
      },
      "id": "4eb27b4c-616d-4109-a5a4-bb0a782d3a9e",
      "name": "Separa os tickets do objeto retornado",
      "type": "n8n-nodes-base.itemLists",
      "typeVersion": 1,
      "position": [
        1180,
        800
      ]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{$node[\"Busca voluntária pelo email\"].json}}",
              "operation": "isNotEmpty"
            }
          ]
        }
      },
      "id": "176bc847-9aef-458a-a39d-ae4249cbcc02",
      "name": "Se retornou a voluntária do Zendesk",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        180,
        820
      ]
    },
    {
      "parameters": {
        "resource": "user",
        "operation": "update",
        "id": "={{ $json[\"id\"] }}",
        "updateFields": {
          "userFieldsUi": {
            "userFieldValues": [
              {
                "field": "condition",
                "value": "capacitacao"
              }
            ]
          }
        }
      },
      "id": "2244999e-5659-409a-9b76-273a1c70b382",
      "name": "Atualiza status da voluntária no Zendesk",
      "type": "n8n-nodes-base.zendesk",
      "typeVersion": 1,
      "position": [
        600,
        60
      ],
      "credentials": {
        "zendeskApi": {
          "id": "MYAFeR51noxrxEC7",
          "name": "Zendesk account"
        }
      }
    },
    {
      "parameters": {
        "resource": "user",
        "operation": "update",
        "id": "={{ $json[\"id\"] }}",
        "updateFields": {
          "userFieldsUi": {
            "userFieldValues": [
              {
                "field": "condition",
                "value": "aprovada"
              }
            ]
          }
        }
      },
      "id": "2b80278f-a43b-4863-9277-aa247998a4fa",
      "name": "Atualiza status da voluntária no Zendesk1",
      "type": "n8n-nodes-base.zendesk",
      "typeVersion": 1,
      "position": [
        440,
        800
      ],
      "credentials": {
        "zendeskApi": {
          "id": "MYAFeR51noxrxEC7",
          "name": "Zendesk account"
        }
      }
    },
    {
      "parameters": {
        "keepOnlySet": true,
        "values": {
          "string": [
            {
              "name": "condition",
              "value": "capacitacao"
            },
            {
              "name": "updated_at",
              "value": "={{$now}}"
            }
          ],
          "number": [
            {
              "name": "id",
              "value": "={{$node[\"Busca voluntária pelo moodle ID\"].json[\"internal_id\"]}}"
            },
            {
              "name": "zendesk_user_id",
              "value": "={{$node[\"Atualiza status da voluntária no Zendesk\"].json[\"id\"]}}"
            }
          ]
        },
        "options": {}
      },
      "id": "99e8f036-d770-4640-bbbc-77aa4417e4c9",
      "name": "Seta os campos para atualizar voluntária no BD",
      "type": "n8n-nodes-base.set",
      "typeVersion": 1,
      "position": [
        980,
        60
      ]
    },
    {
      "parameters": {
        "keepOnlySet": true,
        "values": {
          "string": [
            {
              "name": "status",
              "value": "capacitacao"
            },
            {
              "name": "created_at",
              "value": "={{$now}}"
            }
          ],
          "number": [
            {
              "name": "volunteer_id",
              "value": "={{$node[\"Busca voluntária pelo moodle ID\"].json[\"internal_id\"]}}"
            }
          ]
        },
        "options": {}
      },
      "id": "38958f78-dbc4-4eed-a4a2-c5830a8b65eb",
      "name": "Seta os campos para inserir na tabela volunteer_status_history",
      "type": "n8n-nodes-base.set",
      "typeVersion": 1,
      "position": [
        1560,
        60
      ]
    },
    {
      "parameters": {
        "table": "volunteer_status_history",
        "columns": "volunteer_id,status,created_at",
        "additionalFields": {}
      },
      "id": "2da652b0-2401-4f36-9d74-e212a1a25079",
      "name": "Insere o novo status na tabela volunteer_status_history",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 1,
      "position": [
        1780,
        60
      ],
      "credentials": {
        "postgres": {
          "id": "c5mNsjWNXx3mw1Fh",
          "name": "[PROD] Mapa"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.tickets.custom_fields[6].value }}",
              "value2": "capacitacao"
            }
          ]
        }
      },
      "id": "88c425a4-1e80-4d02-95ad-08b2eed4c487",
      "name": "Se o campo \"Status da Inscrição\" for igual a \"capacitacao\"",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        1340,
        800
      ]
    },
    {
      "parameters": {
        "operation": "limit"
      },
      "id": "eb3e36b1-5f8c-409e-adce-a707e2f826cc",
      "name": "Seleciona o ticket mais antigo",
      "type": "n8n-nodes-base.itemLists",
      "typeVersion": 1,
      "position": [
        1560,
        780
      ]
    },
    {
      "parameters": {
        "operation": "update",
        "id": "={{ $json[\"tickets\"][\"id\"] }}",
        "updateFields": {
          "customFieldsUi": {
            "customFieldsValues": [
              {
                "id": 360021665652,
                "value": "aprovada"
              }
            ]
          }
        }
      },
      "id": "1dc0c5a3-4059-4566-bd8f-905aafac171a",
      "name": "Atualiza o ticket para \"aprovada\"",
      "type": "n8n-nodes-base.zendesk",
      "typeVersion": 1,
      "position": [
        1780,
        780
      ],
      "credentials": {
        "zendeskApi": {
          "id": "MYAFeR51noxrxEC7",
          "name": "Zendesk account"
        }
      }
    },
    {
      "parameters": {
        "keepOnlySet": true,
        "values": {
          "string": [
            {
              "name": "status",
              "value": "aprovada"
            },
            {
              "name": "created_at",
              "value": "={{ $now }} "
            }
          ],
          "number": [
            {
              "name": "volunteer_id",
              "value": "={{$node[\"Busca voluntária pelo moodle ID\"].json[\"internal_id\"]}}"
            }
          ]
        },
        "options": {}
      },
      "id": "2fee76a0-bc6b-4716-a85d-93a8b462c229",
      "name": "Seta os campos para inserir na tabela volunteer_status_history1",
      "type": "n8n-nodes-base.set",
      "typeVersion": 1,
      "position": [
        1980,
        780
      ]
    },
    {
      "parameters": {
        "table": "volunteer_status_history",
        "columns": "volunteer_id,status,created_at",
        "additionalFields": {}
      },
      "id": "23b913c0-ec20-4470-a5f4-8698968618ae",
      "name": "Insere  o registro na volunteer_status_history",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 1,
      "position": [
        2200,
        780
      ],
      "credentials": {
        "postgres": {
          "id": "c5mNsjWNXx3mw1Fh",
          "name": "[PROD] Mapa"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE public.volunteers\nSET condition = '{{ $json[\"condition\"] }}', updated_at = NOW(), zendesk_user_id={{ $json[\"zendesk_user_id\"] }}\nWHERE id = {{ $json[\"id\"] }}",
        "options": {}
      },
      "id": "c8b56c00-4992-4467-ae3a-b19b8d4a006e",
      "name": "Atualiza voluntária no BD",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.3,
      "position": [
        1180,
        60
      ],
      "credentials": {
        "postgres": {
          "id": "c5mNsjWNXx3mw1Fh",
          "name": "[PROD] Mapa"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE volunteers\nSET condition = '{{ $json.condition }}', updated_at = NOW()\nWHERE id = {{ $json.id }}",
        "options": {}
      },
      "id": "26bc07b6-e90d-4daf-b57d-664f963daf89",
      "name": "Atualiza voluntária no BD1",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.3,
      "position": [
        780,
        800
      ],
      "credentials": {
        "postgres": {
          "id": "c5mNsjWNXx3mw1Fh",
          "name": "[PROD] Mapa"
        }
      }
    },
    {
      "parameters": {
        "dataType": "string",
        "value1": "={{$node[\"Webhook\"].json[\"body\"][\"eventname\"]}}",
        "rules": {
          "rules": [
            {
              "value2": "\\mod_page\\event\\course_module_viewed"
            },
            {
              "value2": "\\core\\event\\course_completed",
              "output": 1
            }
          ]
        }
      },
      "id": "b92c1d99-9f7e-4aa4-80d9-513e8384167e",
      "name": "Determina se acessou módulo ou conclusão de curso",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 1,
      "position": [
        -140,
        560
      ]
    },
    {
      "parameters": {
        "errorMessage": "=Não achou a voluntária\nvollunteer_id:  {{$node[\"Busca voluntária pelo moodle ID\"].json[\"internal_id\"]}}"
      },
      "id": "649b4734-e500-44c0-afc3-346bb1cad177",
      "name": "Stop And Error2",
      "type": "n8n-nodes-base.stopAndError",
      "typeVersion": 1,
      "position": [
        500,
        340
      ]
    },
    {
      "parameters": {
        "resource": "user",
        "operation": "search",
        "limit": 30,
        "filters": {
          "query": "={{ $json.email }}"
        }
      },
      "id": "0460f562-be28-459c-9dc1-21dd61101a92",
      "name": "Busca voluntária pelo email1",
      "type": "n8n-nodes-base.zendesk",
      "typeVersion": 1,
      "position": [
        180,
        80
      ],
      "alwaysOutputData": true,
      "credentials": {
        "zendeskApi": {
          "id": "MYAFeR51noxrxEC7",
          "name": "Zendesk account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{$node[\"Busca voluntária pelo email1\"].json}}",
              "operation": "isNotEmpty"
            }
          ]
        }
      },
      "id": "1ae642d4-df00-40fa-a2cf-440103d04227",
      "name": "Se retornou a voluntária do Zendesk1",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        360,
        80
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "b4c9bdc8-6d21-48ea-88c4-6fed9800ea33",
              "leftValue": "={{ $json[\"condition\"] }}",
              "rightValue": "cadastrada",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "6e3e9737-a1d1-42f0-9661-cb38f926324f",
      "name": "O atual status da mulher é cadastrada?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        20,
        320
      ]
    },
    {
      "parameters": {},
      "id": "4af34494-246a-465e-bce9-0bd190becefd",
      "name": "No Operation, do nothing",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        220,
        340
      ]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT email from mdl_user where id = {{$node[\"Webhook\"].json[\"body\"][\n\"userid\"]}}",
        "options": {}
      },
      "id": "b18ff367-8e66-4e44-8c19-9e1e6c64162f",
      "name": "Postgres",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.3,
      "position": [
        -320,
        960
      ],
      "credentials": {
        "postgres": {
          "id": "KHoy20BFgrBIpHYR",
          "name": "[PROD] Moodle"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "8dd0a966-c838-4b5e-b396-a811775c6478",
              "leftValue": "={{ $json[\"email\"] }}",
              "rightValue": "@mapa.org.br",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "cc431e27-3d45-42c2-b9ef-4464c5380655",
      "name": "If",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        -120,
        1080
      ]
    },
    {
      "parameters": {},
      "id": "1387c816-740c-4588-8b23-f31c6989c3e9",
      "name": "No Operation, do nothing1",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        100,
        1040
      ]
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1",
    "saveManualExecutions": true,
    "callerPolicy": "workflowsFromSameOwner",
    "errorWorkflow": "HYstwqyTrzYsvJ2P"
  },
  "staticData": null,
  "tags": [
    {
      "createdAt": "2024-01-24T01:51:54.592Z",
      "updatedAt": "2024-01-24T01:51:54.592Z",
      "id": "9qHi7Mg3P0urkBHm",
      "name": "volunteer"
    }
  ],
  "triggerCount": 1,
  "updatedAt": "2024-02-26T18:28:55.000Z",
  "versionId": "5d6e78e3-000d-475d-abdc-1ee6216aa11f"
}